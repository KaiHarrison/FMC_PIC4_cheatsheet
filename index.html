<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>FSE Run Sheet — Hosts & Instructions</title>
<style>
  :root{
    --bg:#0b0c10;
    --panel:#111217;
    --muted:#9aa3af;
    --text:#e5e7eb;
    --accent:#4f46e5;
    --accent-2:#22c55e;
    --card:#151823;
    --border:#232738;
    --chip:#1f2433;
    --danger:#ef4444;
    --shadow:0 6px 14px rgba(0,0,0,.35),0 2px 6px rgba(0,0,0,.25);
    --radius:14px;
  }
  *{box-sizing:border-box}
  html,body{margin:0;background:linear-gradient(180deg,#0b0c10 0%,#0a0b12 100%);color:var(--text);font-family:ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial;line-height:1.45}
  .wrap{max-width:1100px;margin:24px auto;padding:0 16px}
  header{display:flex;flex-wrap:wrap;align-items:center;gap:12px;margin-bottom:16px}
  header h1{font-size:20px;margin:0;font-weight:700;letter-spacing:.2px}
  .meta{margin-left:auto;display:flex;gap:10px;flex-wrap:wrap}
  .chip{background:var(--chip);border:1px solid var(--border);padding:6px 10px;border-radius:999px;font-size:12px;color:var(--muted)}
  .tabs{display:flex;gap:8px;flex-wrap:wrap;margin:12px 0 18px}
  .tab-btn{appearance:none;border:1px solid var(--border);background:var(--panel);color:var(--text);
    padding:10px 14px;border-radius:10px;cursor:pointer;transition:transform .04s ease,background .2s ease,border-color .2s}
  .tab-btn[aria-selected="true"]{background:linear-gradient(180deg,#1a1d2a,#141826);border-color:#31364b;box-shadow:var(--shadow)}
  .tab-btn:active{transform:translateY(1px)}

  .panel{display:none;animation:fade .18s ease}
  .panel.active{display:block}
  @keyframes fade{from{opacity:.6;transform:translateY(2px)}to{opacity:1;transform:none}}

  /* Search + table */
  .toolbar{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin:8px 0 14px}
  .input{flex:1;min-width:220px;display:flex;align-items:center;background:var(--panel);border:1px solid var(--border);border-radius:10px;padding:8px 10px;gap:8px}
  .input input{all:unset;color:var(--text);flex:1}
  .hint{font-size:12px;color:var(--muted)}
  table{width:100%;border-collapse:collapse;background:var(--card);border:1px solid var(--border);border-radius:12px;overflow:hidden;box-shadow:var(--shadow)}
  th,td{padding:10px 12px;border-bottom:1px dashed #22283a;vertical-align:top}
  th{background:#141826;text-align:left;font-size:13px;color:#c7cbe4;position:sticky;top:0;z-index:1}
  tr:last-child td{border-bottom:none}
  .nowrap{white-space:nowrap}
  .tag{display:inline-block;background:#1c2438;border:1px solid #2a3552;border-radius:8px;padding:2px 8px;font-size:12px;color:#c9d1ff}

  /* Cards */
  .grid{display:grid;grid-template-columns:repeat(1,minmax(0,1fr));gap:14px}
  @media (min-width:640px){.grid{grid-template-columns:repeat(2,minmax(0,1fr))}}
  @media (min-width:980px){.grid{grid-template-columns:repeat(3,minmax(0,1fr))}}
  .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:14px;box-shadow:var(--shadow)}
  .card h3{margin:0 0 6px 0;font-size:15px;letter-spacing:.2px}
  .kv{display:grid;grid-template-columns:110px 1fr;gap:4px 10px;font-size:13px}
  .kv div{padding:3px 0;color:var(--muted)}
  .kv div:nth-child(2n){color:var(--text)}
  .row{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
  .pill{background:#1a2335;border:1px solid #2b3653;border-radius:999px;padding:5px 10px;font-size:12px;color:#cdd4ff}
  .copy{cursor:pointer;border:1px dashed #2f3a57;border-radius:8px;padding:3px 8px;font-size:12px;color:#aab3d1}
  .copy:hover{border-style:solid;color:#e5e9ff}

  /* Instructions */
  details.instructions{background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:12px}
  details[open]{box-shadow:var(--shadow)}
  summary{cursor:pointer;list-style:none;font-weight:700;display:flex;align-items:center;gap:8px}
  summary::-webkit-details-marker{display:none}
  .steps{margin:10px 0 0 0;padding-left:18px}
  .steps li{margin-bottom:6px}
  .kbd{font-family:ui-monospace,Consolas,Menlo,monospace;background:#0f1220;border:1px solid #28304d;color:#dbe3ff;border-radius:6px;padding:0 6px;font-size:12px}
  .callout{margin-top:10px;background:#162033;border:1px solid #28324a;border-radius:10px;padding:10px;font-size:13px;color:#c5d0ee}

  .foot{margin:18px 0 10px;color:var(--muted);font-size:12px;text-align:center}
  .divider{height:1px;background:linear-gradient(90deg,transparent,#27304a,transparent);margin:12px 0}
  .ok{color:var(--accent-2);font-weight:700}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>FSE Run Sheet — PIC iX Host Upgrades</h1>
    <div class="meta">
      <span class="chip">Static HTML</span>
      <span class="chip">Responsive</span>
      <span class="chip">Tap to copy</span>
    </div>
  </header>

  <nav class="tabs" role="tablist" aria-label="Sections">
    <button class="tab-btn" role="tab" aria-selected="true" aria-controls="panel-summary" id="tab-summary">Summary</button>
    <button class="tab-btn" role="tab" aria-selected="false" aria-controls="panel-ryan" id="tab-ryan">Ryan</button>
    <button class="tab-btn" role="tab" aria-selected="false" aria-controls="panel-maria" id="tab-maria">Maria</button>
    <button class="tab-btn" role="tab" aria-selected="false" aria-controls="panel-kai" id="tab-kai">Kai</button>
  </nav>

  <!-- SUMMARY -->
  <section class="panel active" id="panel-summary" role="tabpanel" aria-labelledby="tab-summary">
    <div class="toolbar">
      <div class="input">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.3-4.3M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z" stroke="#8b95b3" stroke-width="2" stroke-linecap="round"/></svg>
        <input id="search" placeholder="Search by host, ward, level, IP, VLAN, FSE, printer…" />
      </div>
      <span class="hint">Sort by clicking headers • Shift+click for multi-sort</span>
    </div>
    <div style="overflow:auto;border-radius:12px">
      <table id="host-table">
        <thead>
          <tr>
            <th data-key="FSE">FSE</th>
            <th data-key="Level" class="nowrap">Building Lvl</th>
            <th data-key="Host" class="nowrap">Host Name</th>
            <th data-key="IP" class="nowrap">IP Address</th>
            <th data-key="Subnet" class="nowrap">Subnet Mask</th>
            <th data-key="GW" class="nowrap">Gateway</th>
            <th data-key="VLAN" class="nowrap">VLAN</th>
            <th data-key="DNS1" class="nowrap">Primary DNS</th>
            <th data-key="DNS2" class="nowrap">Secondary DNS</th>
            <th data-key="Printer" class="nowrap">Printer Name</th>
            <th data-key="PrinterIP" class="nowrap">Printer IP</th>
          </tr>
        </thead>
        <tbody id="host-tbody"></tbody>
      </table>
    </div>

    <div class="divider"></div>
    <div class="grid" id="rollup">
      <!-- Roll-up cards will be injected -->
    </div>
    <p class="foot">Tip: Tap any <span class="kbd">Host</span> or <span class="kbd">IP</span> in cards to copy. Same instructions apply to all hosts.</p>
  </section>

  <!-- RYAN -->
  <section class="panel" id="panel-ryan" role="tabpanel" aria-labelledby="tab-ryan">
    <details class="instructions" open>
      <summary>Standard Upgrade Instructions (apply to every host)</summary>
      <ol class="steps">
        <li>Speak with ward staff, confirm downtime approval to begin.</li>
        <li>Open <span class="kbd">System Config → Control Panel</span>; photograph existing printer name + IP.</li>
        <li>Insert <strong>Media Kit</strong> into rear USB.</li>
        <li>Reboot PC (<span class="kbd">Alt</span>+<span class="kbd">F4</span>).</li>
        <li>During boot press <span class="kbd">F9</span> → select USB Media Kit.</li>
        <li>Confirm warning dialogs ×2 → install starts (~20 min). PC may reboot multiple times.</li>
        <li>When Windows taskbar appears you may remove Media Kit and move to next PC.</li>
        <li>At <strong>PIC iX Setup</strong>: set Hostname & IP (per label), Subnet <span class="kbd">255.255.248.0</span>, DNS1 <span class="kbd">172.31.3.1</span>, DNS2 <span class="kbd">172.31.3.2</span>, Advanced → domain <span class="kbd">intellivue.net</span>. Reboot after changes.</li>
        <li>Control Panel → Install printer(s): same name & IP as before, <strong>HP PCL</strong> driver, paper <strong>A4</strong>.</li>
        <li>Run <strong>PIC iX Setup</strong>:</li>
        <ul>
          <li>Regional: <strong>English (Australia)</strong></li>
          <li>Install Product Databases (wait 2 min)</li>
          <li>Config Server: <strong>Other Host → SFMCPRIMARY</strong></li>
          <li>Password: <span class="kbd">WCX3TCg)</span></li>
          <li>Credentials when prompted: user <span class="kbd">philipsfieldengr</span> / pass <span class="kbd">FE+Sup42p0rt!</span></li>
          <li>Request Encryption Configuration (auto)</li>
          <li>Licensing/topology: leave as-is (hostname must be correct)</li>
          <li>Test speaker functionality → confirm</li>
        </ul>
        <li>Proceed Next → Host Qualification (confirm no failures).</li>
        <li>Next → <strong>Start Patient Monitoring Services</strong> → reboot.</li>
        <li>System should auto-start and connect to monitors. Verify.</li>
      </ol>
      <div class="callout">Note: If any step fails, capture screenshots, retain logs, and record exact host + time. Revert only after consulting lead.</div>
    </details>
    <div class="divider"></div>
    <div class="grid" id="grid-ryan"></div>
  </section>

  <!-- MARIA -->
  <section class="panel" id="panel-maria" role="tabpanel" aria-labelledby="tab-maria">
    <details class="instructions" open>
      <summary>Standard Upgrade Instructions (apply to every host)</summary>
      <ol class="steps">
        <li>Speak with ward staff, confirm downtime approval to begin.</li>
        <li>Open <span class="kbd">System Config → Control Panel</span>; photograph existing printer name + IP.</li>
        <li>Insert <strong>Media Kit</strong> into rear USB.</li>
        <li>Reboot PC (<span class="kbd">Alt</span>+<span class="kbd">F4</span>).</li>
        <li>During boot press <span class="kbd">F9</span> → select USB Media Kit.</li>
        <li>Confirm warning dialogs ×2 → install starts (~20 min). PC may reboot multiple times.</li>
        <li>When Windows taskbar appears you may remove Media Kit and move to next PC.</li>
        <li>At <strong>PIC iX Setup</strong>: set Hostname & IP (per label), Subnet <span class="kbd">255.255.248.0</span>, DNS1 <span class="kbd">172.31.3.1</span>, DNS2 <span class="kbd">172.31.3.2</span>, Advanced → domain <span class="kbd">intellivue.net</span>. Reboot after changes.</li>
        <li>Control Panel → Install printer(s): same name & IP as before, <strong>HP PCL</strong> driver, paper <strong>A4</strong>.</li>
        <li>Run <strong>PIC iX Setup</strong>:</li>
        <ul>
          <li>Regional: <strong>English (Australia)</strong></li>
          <li>Install Product Databases (wait 2 min)</li>
          <li>Config Server: <strong>Other Host → SFMCPRIMARY</strong></li>
          <li>Password: <span class="kbd">WCX3TCg)</span></li>
          <li>Credentials when prompted: user <span class="kbd">philipsfieldengr</span> / pass <span class="kbd">FE+Sup42p0rt!</span></li>
          <li>Request Encryption Configuration (auto)</li>
          <li>Licensing/topology: leave as-is (hostname must be correct)</li>
          <li>Test speaker functionality → confirm</li>
        </ul>
        <li>Proceed Next → Host Qualification (confirm no failures).</li>
        <li>Next → <strong>Start Patient Monitoring Services</strong> → reboot.</li>
        <li>System should auto-start and connect to monitors. Verify.</li>
      </ol>
      <div class="callout">Note: If any step fails, capture screenshots, retain logs, and record exact host + time. Revert only after consulting lead.</div>
    </details>
    <div class="divider"></div>
    <div class="grid" id="grid-maria"></div>
  </section>

  <!-- KAI -->
  <section class="panel" id="panel-kai" role="tabpanel" aria-labelledby="tab-kai">
    <details class="instructions" open>
      <summary>Standard Upgrade Instructions (apply to every host)</summary>
      <ol class="steps">
        <li>Speak with ward staff, confirm downtime approval to begin.</li>
        <li>Open <span class="kbd">System Config → Control Panel</span>; photograph existing printer name + IP.</li>
        <li>Insert <strong>Media Kit</strong> into rear USB.</li>
        <li>Reboot PC (<span class="kbd">Alt</span>+<span class="kbd">F4</span>).</li>
        <li>During boot press <span class="kbd">F9</span> → select USB Media Kit.</li>
        <li>Confirm warning dialogs ×2 → install starts (~20 min). PC may reboot multiple times.</li>
        <li>When Windows taskbar appears you may remove Media Kit and move to next PC.</li>
        <li>At <strong>PIC iX Setup</strong>: set Hostname & IP (per label), Subnet <span class="kbd">255.255.248.0</span>, DNS1 <span class="kbd">172.31.3.1</span>, DNS2 <span class="kbd">172.31.3.2</span>, Advanced → domain <span class="kbd">intellivue.net</span>. Reboot after changes.</li>
        <li>Control Panel → Install printer(s): same name & IP as before, <strong>HP PCL</strong> driver, paper <strong>A4</strong>.</li>
        <li>Run <strong>PIC iX Setup</strong>:</li>
        <ul>
          <li>Regional: <strong>English (Australia)</strong></li>
          <li>Install Product Databases (wait 2 min)</li>
          <li>Config Server: <strong>Other Host → SFMCPRIMARY</strong></li>
          <li>Password: <span class="kbd">WCX3TCg)</span></li>
          <li>Credentials when prompted: user <span class="kbd">philipsfieldengr</span> / pass <span class="kbd">FE+Sup42p0rt!</span></li>
          <li>Request Encryption Configuration (auto)</li>
          <li>Licensing/topology: leave as-is (hostname must be correct)</li>
          <li>Test speaker functionality → confirm</li>
        </ul>
        <li>Proceed Next → Host Qualification (confirm no failures).</li>
        <li>Next → <strong>Start Patient Monitoring Services</strong> → reboot.</li>
        <li>System should auto-start and connect to monitors. Verify.</li>
      </ol>
      <div class="callout">Note: If any step fails, capture screenshots, retain logs, and record exact host + time. Revert only after consulting lead.</div>
    </details>
    <div class="divider"></div>
    <div class="grid" id="grid-kai"></div>
  </section>

  <p class="foot">Built for fast ward execution • Minimal taps • Offline-friendly • No external libs</p>
</div>

<script>
/** ---------- Data (single source of truth) ---------- **/
const HOSTS = [
  {FSE:"Ryan", Level:"Level 6", Host:"SFMCCCUSurv1", IP:"172.31.11.32", Subnet:"255.255.248.0", GW:"172.31.8.1", VLAN:"102", DNS1:"172.31.3.1", DNS2:"172.31.3.2", Printer:"CCUprinter", PrinterIP:"172.31.11.99"},
  {FSE:"Ryan", Level:"Level 6", Host:"SFMC6DCSurv1", IP:"172.31.11.33", Subnet:"255.255.248.0", GW:"172.31.8.1", VLAN:"102", DNS1:"172.31.3.1", DNS2:"172.31.3.2", Printer:"6DCprinter", PrinterIP:"172.31.11.98"},
  {FSE:"Ryan", Level:"Level 6", Host:"SFMC6DNSSurv1", IP:"172.31.11.34", Subnet:"255.255.248.0", GW:"172.31.8.1", VLAN:"102", DNS1:"172.31.3.1", DNS2:"172.31.3.2", Printer:"6DNSprinter", PrinterIP:"172.31.11.97"},
  {FSE:"Ryan", Level:"Level 6", Host:"SFMC6BSurv1", IP:"172.31.11.35", Subnet:"255.255.248.0", GW:"172.31.8.1", VLAN:"102", DNS1:"172.31.3.1", DNS2:"172.31.3.2", Printer:"6Bprinter", PrinterIP:"172.31.11.96"},
  {FSE:"Ryan", Level:"Level 6", Host:"SFMC6ASurv1", IP:"172.31.11.36", Subnet:"255.255.248.0", GW:"172.31.8.1", VLAN:"103", DNS1:"172.31.3.1", DNS2:"172.31.3.2", Printer:"6Aprinter", PrinterIP:"172.31.11.100"},

  {FSE:"Maria", Level:"Level 3", Host:"SFMCICUESurv1", IP:"172.31.19.32", Subnet:"255.255.248.0", GW:"172.31.16.1", VLAN:"103", DNS1:"172.31.3.1", DNS2:"172.31.3.2", Printer:"ICUEprinter", PrinterIP:"172.31.19.96"},
  {FSE:"Maria", Level:"Level 3", Host:"SFMCICUCSurv1", IP:"172.31.19.33", Subnet:"255.255.248.0", GW:"172.31.16.1", VLAN:"103", DNS1:"172.31.3.1", DNS2:"172.31.3.2", Printer:"ICUCprinter", PrinterIP:"172.31.19.97"},
  {FSE:"Maria", Level:"Level 3", Host:"SFMCICUWSurv1", IP:"172.31.19.34", Subnet:"255.255.248.0", GW:"172.31.16.1", VLAN:"103", DNS1:"172.31.3.1", DNS2:"172.31.3.2", Printer:"ICUWprinter", PrinterIP:"172.31.19.98"},
  {FSE:"Maria", Level:"Level 3", Host:"SFMC3GSurv1", IP:"172.31.27.32", Subnet:"255.255.248.0", GW:"172.31.24.1", VLAN:"104", DNS1:"172.31.3.1", DNS2:"172.31.3.2", Printer:"3Gprinter", PrinterIP:"172.31.27.99"},
  {FSE:"Maria", Level:"Level 4", Host:"SFMC4GSurv1", IP:"172.31.27.33", Subnet:"255.255.248.0", GW:"172.31.24.1", VLAN:"104", DNS1:"172.31.3.1", DNS2:"172.31.3.2", Printer:"4Gprinter", PrinterIP:"172.31.27.97"},

  {FSE:"Kai", Level:"Level 3", Host:"SFMCEDASurv1", IP:"172.31.27.34", Subnet:"255.255.248.0", GW:"172.31.24.1", VLAN:"104", DNS1:"172.31.3.1", DNS2:"172.31.3.2", Printer:"EDAprinter", PrinterIP:"172.31.27.98"},
  {FSE:"Kai", Level:"Level 3", Host:"SFMCEDDSurv1", IP:"172.31.27.35", Subnet:"255.255.248.0", GW:"172.31.24.1", VLAN:"104", DNS1:"172.31.3.1", DNS2:"172.31.3.2", Printer:"EDDprinter", PrinterIP:"172.31.27.96"},
  {FSE:"Kai", Level:"Level 3", Host:"SFMCEDPAEDSurv1", IP:"172.31.27.36", Subnet:"255.255.248.0", GW:"172.31.24.1", VLAN:"104", DNS1:"172.31.3.1", DNS2:"172.31.3.2", Printer:"EDPprinter", PrinterIP:"172.31.27.100"},
  {FSE:"Kai", Level:"Level 3", Host:"SFMCRESUSSurv1", IP:"172.31.27.37", Subnet:"255.255.248.0", GW:"172.31.24.1", VLAN:"104", DNS1:"172.31.3.1", DNS2:"172.31.3.2", Printer:"EDRprinter", PrinterIP:"172.31.27.101"},
  {FSE:"Kai", Level:"Level 3", Host:"SFMCEDSSurv1", IP:"172.31.27.38", Subnet:"255.255.248.0", GW:"172.31.24.1", VLAN:"104", DNS1:"172.31.3.1", DNS2:"172.31.3.2", Printer:"EDSprinter", PrinterIP:"172.31.27.102"},
  {FSE:"Kai", Level:"Level 4", Host:"SFMCPaedSurv1", IP:"172.31.27.39", Subnet:"255.255.248.0", GW:"172.31.24.1", VLAN:"105", DNS1:"172.31.3.1", DNS2:"172.31.3.2", Printer:"PAEprinter", PrinterIP:"172.31.27.103"}
];

/** ---------- Tabs ---------- **/
const tabs = [...document.querySelectorAll('.tab-btn')];
const panels = [...document.querySelectorAll('.panel')];
tabs.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    tabs.forEach(b=>b.setAttribute('aria-selected','false'));
    btn.setAttribute('aria-selected','true');
    panels.forEach(p=>p.classList.remove('active'));
    document.getElementById(btn.getAttribute('aria-controls')).classList.add('active');
  });
});

/** ---------- Summary table (search + sort) ---------- **/
const tbody = document.getElementById('host-tbody');
let currentSort = [];
const renderTable = (rows) => {
  tbody.innerHTML = rows.map(r=>`
    <tr>
      <td>${r.FSE}</td>
      <td class="nowrap">${r.Level}</td>
      <td class="nowrap"><span class="copy" data-copy="${r.Host}">${r.Host}</span></td>
      <td class="nowrap"><span class="copy" data-copy="${r.IP}">${r.IP}</span></td>
      <td class="nowrap">${r.Subnet}</td>
      <td class="nowrap">${r.GW}</td>
      <td class="nowrap"><span class="tag">VLAN ${r.VLAN}</span></td>
      <td class="nowrap">${r.DNS1}</td>
      <td class="nowrap">${r.DNS2}</td>
      <td class="nowrap">${r.Printer}</td>
      <td class="nowrap"><span class="copy" data-copy="${r.PrinterIP}">${r.PrinterIP}</span></td>
    </tr>
  `).join('');
  enableCopy();
};
const getSorted = (rows) => {
  if(!currentSort.length) return rows;
  return [...rows].sort((a,b)=>{
    for(const s of currentSort){
      const {key,dir} = s;
      const av = a[key] ?? ""; const bv = b[key] ?? "";
      if(av === bv) continue;
      if(!isNaN(Number(av)) && !isNaN(Number(bv))){
        return dir * (Number(av)-Number(bv));
      }
      return dir * String(av).localeCompare(String(bv), undefined, {numeric:true,sensitivity:'base'});
    }
    return 0;
  });
};
renderTable(HOSTS);

document.getElementById('search').addEventListener('input', (e)=>{
  const q = e.target.value.trim().toLowerCase();
  const filtered = HOSTS.filter(h=>Object.values(h).some(v=>String(v).toLowerCase().includes(q)));
  renderTable(getSorted(filtered));
});
[...document.querySelectorAll('th[data-key]')].forEach(th=>{
  th.style.cursor='pointer';
  th.title='Click to sort';
  th.addEventListener('click',(e)=>{
    const key = th.dataset.key;
    const multi = e.shiftKey;
    const existing = currentSort.find(s=>s.key===key);
    if(!multi) currentSort=[];
    if(!existing){ currentSort.push({key,dir:1}); }
    else if(existing.dir===1){ existing.dir=-1; }
    else { currentSort = currentSort.filter(s=>s.key!==key); }
    renderTable(getSorted([...document.querySelectorAll('#search')][0].value? HOSTS.filter(h=>Object.values(h).some(v=>String(v).toLowerCase().includes(document.getElementById('search').value.toLowerCase()))):HOSTS));
  });
});

/** ---------- Roll-up cards (counts by FSE / VLAN / Level) ---------- **/
const roll = document.getElementById('rollup');
const countBy = (key) => Object.entries(HOSTS.reduce((acc,h)=>((acc[h[key]]=(acc[h[key]]||0)+1),acc),{}));
const makeRollCard = (title, items) => {
  const div = document.createElement('div');
  div.className='card';
  div.innerHTML = `<h3>${title}</h3><div class="row">${items.map(([k,v])=>`<span class="pill">${k}: <strong>${v}</strong></span>`).join('')}</div>`;
  return div;
};
roll.append(
  makeRollCard('By FSE', countBy('FSE')),
  makeRollCard('By VLAN', countBy('VLAN')),
  makeRollCard('By Level', countBy('Level'))
);

/** ---------- FSE grids ---------- **/
const byFSE = (name)=>HOSTS.filter(h=>h.FSE===name);
const cardHTML = (h)=>`
  <div class="card">
    <h3>${h.Host}</h3>
    <div class="kv">
      <div>FSE</div><div>${h.FSE}</div>
      <div>Level</div><div>${h.Level}</div>
      <div>IP</div><div><span class="copy" data-copy="${h.IP}">${h.IP}</span></div>
      <div>Subnet</div><div>${h.Subnet}</div>
      <div>Gateway</div><div>${h.GW}</div>
      <div>VLAN</div><div><span class="tag">VLAN ${h.VLAN}</span></div>
      <div>DNS</div><div>${h.DNS1} • ${h.DNS2}</div>
      <div>Printer</div><div>${h.Printer} — <span class="copy" data-copy="${h.PrinterIP}">${h.PrinterIP}</span></div>
      <div>Domain</div><div>intellivue.net</div>
    </div>
    <div class="row">
      <span class="pill">Hostname: <span class="copy" data-copy="${h.Host}">${h.Host}</span></span>
      <span class="pill">OK to proceed: <span class="ok">confirm</span></span>
    </div>
  </div>
`;
const mountGrid = (id, arr)=>{
  const el = document.getElementById(id);
  el.innerHTML = arr.map(cardHTML).join('');
  enableCopy();
};
mountGrid('grid-ryan', byFSE('Ryan'));
mountGrid('grid-maria', byFSE('Maria'));
mountGrid('grid-kai', byFSE('Kai'));

/** ---------- Copy helper ---------- **/
function enableCopy(){
  document.querySelectorAll('.copy').forEach(el=>{
    el.addEventListener('click', async ()=>{
      try{
        await navigator.clipboard.writeText(el.dataset.copy);
        const old = el.textContent;
        el.textContent = 'Copied ✓';
        setTimeout(()=>{ el.textContent = old; }, 900);
      }catch(e){
        alert('Copy failed: ' + e);
      }
    }, {once:false});
  });
}
</script>
</body>
</html>
