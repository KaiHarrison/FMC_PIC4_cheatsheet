<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FSE Run Sheet Â· Summary + Ryan + Maria + Kai</title>
  <style>
    :root{
      --bg: #0f1115;           /* dark slate */
      --panel: #151922;        /* card */
      --muted: #9aa4b2;        /* text secondary */
      --text: #e7edf5;         /* text primary */
      --brand: #5dd3ff;        /* accent */
      --brand-2:#7ef7d4;       /* accent 2 */
      --ok:#79e39e;            /* good */
      --warn:#ffcf6b;          /* warn */
      --danger:#ff8b8b;        /* danger */
      --ring: 0 0 0 2px rgba(93,211,255,.35);
      --radius: 16px;
    }
    html,body{height:100%;}
    body{
      margin:0; background:linear-gradient(180deg,#0b0d12,#0f1115 15% 85%,#0b0d12);
      color:var(--text); font:400 16px/1.5 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }
    .wrap{max-width:1100px;margin:24px auto;padding:0 16px 40px;}
    header{position:sticky;top:0;z-index:10;backdrop-filter:saturate(1.1) blur(8px);
      background:linear-gradient(180deg,rgba(15,17,21,.9),rgba(15,17,21,.6));
      border-bottom:1px solid rgba(255,255,255,.06)}
    header .inner{max-width:1100px;margin:0 auto;padding:14px 16px;display:flex;gap:14px;align-items:center;}
    h1{font-size:20px;margin:0 12px 0 0;letter-spacing:.2px}
    .tag{font-size:12px;color:var(--bg);background:linear-gradient(135deg,var(--brand),var(--brand-2));
      padding:2px 8px;border-radius:999px;font-weight:700}
    .tabs{display:flex;gap:8px;flex-wrap:wrap}
    .tab-btn{background:var(--panel);border:1px solid rgba(255,255,255,.08);color:var(--text);
      padding:8px 12px;border-radius:12px;cursor:pointer;transition:.15s;display:flex;align-items:center;gap:8px}
    .tab-btn:hover{transform:translateY(-1px)}
    .tab-btn.active{background:linear-gradient(180deg,#1a2030,#151922);box-shadow:var(--ring);border-color:transparent}
    .count{font-size:12px;padding:2px 6px;background:#1f2636;border:1px solid rgba(255,255,255,.08);border-radius:999px;color:var(--muted)}
    .panel{background:linear-gradient(180deg,#121722,#121520);border:1px solid rgba(255,255,255,.08);
      border-radius:var(--radius);padding:18px; margin-top:16px}
    .grid{display:grid;gap:16px}
    @media(min-width:900px){.grid{grid-template-columns:1.2fr .8fr}}
    .search{display:flex;gap:10px;align-items:center}
    .search input{flex:1;padding:12px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.12);background:#0f1320;color:var(--text)}
    .search input:focus{outline:none;box-shadow:var(--ring);border-color:transparent}
    .pill{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;background:#1d2434;border:1px solid rgba(255,255,255,.08);color:var(--muted);font-size:12px}

    .steps{counter-reset:step;display:flex;flex-direction:column;gap:10px}
    .step{display:flex;gap:10px;align-items:flex-start;background:#101522;border:1px dashed rgba(255,255,255,.09);
      padding:10px 12px;border-radius:12px}
    .step input{margin-top:4px}
    .step .num{width:28px;height:28px;border-radius:8px;background:#0e1422;border:1px solid rgba(255,255,255,.1);display:flex;align-items:center;justify-content:center;color:var(--brand-2);font-weight:700}
    .step.done{opacity:.7}

    table{width:100%;border-collapse:separate;border-spacing:0 8px}
    thead th{font-size:12px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:.08em;padding:0 10px}
    tbody tr{background:#0e1422;border:1px solid rgba(255,255,255,.08)}
    tbody tr td{padding:10px;border-top:1px solid rgba(255,255,255,.08);border-bottom:1px solid rgba(255,255,255,.08)}
    tbody tr td:first-child{border-left:1px solid rgba(255,255,255,.08);border-top-left-radius:12px;border-bottom-left-radius:12px}
    tbody tr td:last-child{border-right:1px solid rgba(255,255,255,.08);border-top-right-radius:12px;border-bottom-right-radius:12px}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace}
    .chip{font-size:12px;padding:2px 8px;border-radius:999px;border:1px solid rgba(255,255,255,.12);background:#151b2a;color:var(--text)}
    .muted{color:var(--muted)}
    .note{font-size:13px;color:var(--muted)}

    /* Responsive table */
    @media(max-width:800px){
      thead{display:none}
      tbody tr{display:grid;grid-template-columns:1fr 1fr;gap:8px;padding:10px}
      tbody tr td{border:0;padding:2px 0}
      tbody tr td[data-label]{position:relative;padding-left:0}
      tbody tr td[data-label]::before{content:attr(data-label);display:block;font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:.08em;margin-bottom:2px}
    }

    .kbd{font:600 12px/1 ui-monospace, SFMono-Regular, Menlo, Consolas; padding:3px 6px;border-radius:6px;border:1px solid rgba(255,255,255,.12);background:#0f1422}
    .toast{position:fixed;bottom:16px;left:50%;transform:translateX(-50%);background:#121a2a;border:1px solid rgba(255,255,255,.12);padding:10px 14px;border-radius:999px;opacity:0;transition:.2s}
    .toast.show{opacity:1}
  </style>
</head>
<body>
  <header>
    <div class="inner">
      <h1>FSE Run Sheet</h1>
      <span class="tag">PIC iX Host Upgrade</span>
      <div class="tabs" id="tabs"></div>
    </div>
  </header>

  <div class="wrap">
    <div id="view"></div>
  </div>

  <div id="toast" class="toast">Copied to clipboard</div>

  <script>
  // --- Data ---------------------------------------------------------------
  const hosts = [
    {fse:'Ryan', start:'12:00', level:'Level 6', host:'SFMCCCUSurv1', ip:'172.31.11.32', mask:'255.255.248.0', gw:'172.31.8.1', vlan:'102', dns1:'172.31.3.1', dns2:'172.31.3.2'},
    {fse:'Ryan', start:'12:15', level:'Level 6', host:'SFMC6DCSurv1', ip:'172.31.11.33', mask:'255.255.248.0', gw:'172.31.8.1', vlan:'102', dns1:'172.31.3.1', dns2:'172.31.3.2'},
    {fse:'Ryan', start:'12:30', level:'Level 6', host:'SFMC6DNSSurv1', ip:'172.31.11.34', mask:'255.255.248.0', gw:'172.31.8.1', vlan:'102', dns1:'172.31.3.1', dns2:'172.31.3.2'},
    {fse:'Ryan', start:'12:45', level:'Level 6', host:'SFMC6BSurv1', ip:'172.31.11.35', mask:'255.255.248.0', gw:'172.31.8.1', vlan:'102', dns1:'172.31.3.1', dns2:'172.31.3.2'},
    {fse:'Ryan', start:'1:00', level:'Level 6', host:'SFMC6ASurv1', ip:'172.31.11.36', mask:'255.255.248.0', gw:'172.31.8.1', vlan:'103', dns1:'172.31.3.1', dns2:'172.31.3.2'},

    {fse:'Maria', start:'12:00', level:'Level 3', host:'SFMCICUESurv1', ip:'172.31.19.32', mask:'255.255.248.0', gw:'172.31.16.1', vlan:'103', dns1:'172.31.3.1', dns2:'172.31.3.2'},
    {fse:'Maria', start:'12:15', level:'Level 3', host:'SFMCICUCSurv1', ip:'172.31.19.33', mask:'255.255.248.0', gw:'172.31.16.1', vlan:'103', dns1:'172.31.3.1', dns2:'172.31.3.2'},
    {fse:'Maria', start:'12:30', level:'Level 3', host:'SFMCICUWSurv1', ip:'172.31.19.34', mask:'255.255.248.0', gw:'172.31.16.1', vlan:'103', dns1:'172.31.3.1', dns2:'172.31.3.2'},
    {fse:'Maria', start:'12:45', level:'Level 3', host:'SFMC3GSurv1', ip:'172.31.27.32', mask:'255.255.248.0', gw:'172.31.24.1', vlan:'104', dns1:'172.31.3.1', dns2:'172.31.3.2'},
    {fse:'Maria', start:'1:00', level:'Level 4', host:'SFMC4GSurv1', ip:'172.31.27.33', mask:'255.255.248.0', gw:'172.31.24.1', vlan:'104', dns1:'172.31.3.1', dns2:'172.31.3.2'},
    {fse:'Maria', start:'12:45', level:'Level 4', host:'SFMCPaedSurv1', ip:'172.31.27.39', mask:'255.255.248.0', gw:'172.31.24.1', vlan:'105', dns1:'172.31.3.1', dns2:'172.31.3.2'},

    {fse:'Kai', start:'12:30', level:'Level 3', host:'SFMCEDASurv1', ip:'172.31.27.34', mask:'255.255.248.0', gw:'172.31.24.1', vlan:'104', dns1:'172.31.3.1', dns2:'172.31.3.2'},
    {fse:'Kai', start:'12:45', level:'Level 3', host:'SFMCEDDSurv1', ip:'172.31.27.35', mask:'255.255.248.0', gw:'172.31.24.1', vlan:'104', dns1:'172.31.3.1', dns2:'172.31.3.2'},
    {fse:'Kai', start:'1:00', level:'Level 3', host:'SFMCEDPAEDSurv1', ip:'172.31.27.36', mask:'255.255.248.0', gw:'172.31.24.1', vlan:'104', dns1:'172.31.3.1', dns2:'172.31.3.2'},
    {fse:'Kai', start:'2:30', level:'Level 3', host:'SFMCRESUSSurv1', ip:'172.31.27.37', mask:'255.255.248.0', gw:'172.31.24.1', vlan:'104', dns1:'172.31.3.1', dns2:'172.31.3.2'},
    {fse:'Kai', start:'2:45', level:'Level 3', host:'SFMCEDSSurv1', ip:'172.31.27.38', mask:'255.255.248.0', gw:'172.31.24.1', vlan:'104', dns1:'172.31.3.1', dns2:'172.31.3.2'},
  ];

  const instructions = [
    'Talk to ward staff, warn of downtime and get OK to begin',
    'Enter System Config â†’ Control Panel and photograph printer(s) details (name, IP address)',
    'Insert Media Kit in rear USB',
    'Reboot PC â€” press <Alt>+<F4>',
    'Press <F9> during boot â†’ Select USB Media Kit',
    'Click OK on warning dialogs Ã—2 â†’ Install process begins (~20 mins)',
    'PC will reboot several times; once Windows Taskbar is shown remove Media Kit and start next PC',
    'At PIC iX Setup: set Hostname & IP as per chassis label; Subnet 255.255.248.0; DNS 172.31.3.1 & 172.31.3.2; Advanced â†’ Domain intellivue.net',
    'Reboot after all above settings are changed',
    'Control Panel â†’ Install printer(s) using previous name & IP, HP PCL driver, paper A4',
    'Run PIC iX Setup',
    'Regional Settings: English (Australia)',
    'Install Product Databases (wait 2 minutes)',
    "Configuration Server: Other Host â†’ SFMCPRIMARY",
    'Enter password â€œWCX3TCg)â€',
    'When prompted, user: philipsfieldengr; password: â€œFE+Sup42p0rt!â€',
    'Request Encryption Configuration (auto-configured)',
    'Licensing/topology should remain unchanged (ensure Hostname is correct)',
    'Test speaker functionality â€” confirm sound',
    'Proceed Next â†’ Next until Host Qualification; verify no failures',
    'Next â†’ Start Patient Monitoring Services and reboot',
    'System should auto-start and connect to monitors'
  ];

  // --- Utilities ----------------------------------------------------------
  const $ = sel => document.querySelector(sel);
  const el = (tag, props={}, ...children) => {
    const x = document.createElement(tag);
    Object.entries(props).forEach(([k,v])=>{
      if(k==='class') x.className=v; else if(k==='html') x.innerHTML=v; else if(k.startsWith('on')) x.addEventListener(k.slice(2), v); else x.setAttribute(k,v);
    });
    children.flat().forEach(c=>x.appendChild(typeof c==='string'?document.createTextNode(c):c));
    return x;
  }
  const toast = (msg) => { const t=$('#toast'); t.textContent=msg; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'),1200); }

  const copy = (text) => navigator.clipboard.writeText(text).then(()=>toast('Copied to clipboard'));

  const timeSort = (a,b)=>{
    const p = s=>{const [h,m]=s.split(':'); let hh=parseInt(h,10); if(hh===12 && s.includes(':') && s.indexOf(':')===2 && !s.toLowerCase().includes('am')){}; // keep
      // Treat 1:00 etc as 13:00 for ordering
      return (hh<8?hh+12:hh)*60 + parseInt(m,10);
    };
    return p(a.start)-p(b.start);
  }

  const groupBy = (arr, key) => arr.reduce((acc,cur)=>{(acc[cur[key]]??=[]).push(cur);return acc},{});

  // --- Rendering ----------------------------------------------------------
  const TABS = ['Summary','Ryan','Maria','Kai'];

  function renderTabs(){
    const counts = Object.fromEntries(Object.entries(groupBy(hosts,'fse')).map(([k,v])=>[k,v.length]));
    const wrap = $('#tabs');
    wrap.innerHTML='';
    TABS.forEach(name=>{
      const c = name==='Summary'?hosts.length:counts[name]||0;
      const btn = el('button',{class:'tab-btn'+(name==='Summary'?' active':''), onClick:()=>activate(name)},
        el('span',{},name), el('span',{class:'count'},c));
      wrap.appendChild(btn);
    })
  }

  function badge(text){ return el('span',{class:'pill'}, text); }

  function tableFor(rows){
    const thead = el('thead',{}, el('tr',{},
      el('th',{},'Start'), el('th',{},'Building Lvl'), el('th',{},'Host Name'), el('th',{},'IP Address'), el('th',{},'Subnet Mask'), el('th',{},'Gateway'), el('th',{},'VLAN'), el('th',{},'DNS 1'), el('th',{},'DNS 2')
    ));
    const tbody = el('tbody');
    rows.forEach(r=>{
      const row = el('tr', {onDblclick:()=>copy(`${r.host} ${r.ip}`)});
      row.append(
        el('td',{'data-label':'Start'}, r.start),
        el('td',{'data-label':'Building Lvl'}, r.level),
        el('td',{'data-label':'Host Name'}, el('span',{class:'mono'}, r.host), ' ', el('button',{class:'pill',title:'Copy hostname',onClick:(e)=>{e.stopPropagation();copy(r.host)}},'Copy')),
        el('td',{'data-label':'IP Address'}, el('span',{class:'mono'}, r.ip), ' ', el('button',{class:'pill',title:'Copy IP',onClick:(e)=>{e.stopPropagation();copy(r.ip)}},'Copy')),
        el('td',{'data-label':'Subnet Mask'}, el('span',{class:'mono'}, r.mask)),
        el('td',{'data-label':'Gateway'}, el('span',{class:'mono'}, r.gw)),
        el('td',{'data-label':'VLAN'}, el('span',{class:'chip'}, r.vlan)),
        el('td',{'data-label':'DNS 1'}, el('span',{class:'mono'}, r.dns1)),
        el('td',{'data-label':'DNS 2'}, el('span',{class:'mono'}, r.dns2)),
      );
      tbody.appendChild(row);
    })
    return el('table',{}, thead, tbody);
  }

  function stepsBlock(){
    const box = el('div', {class:'panel'});
    box.append(el('h2', {style:'margin:0 0 6px;font-size:18px'}, 'Procedure (applies to all hosts)'));
    box.append(el('div',{class:'note',html:'Tip: click the <span class="kbd">Copy</span> buttons in the table to copy host/IP. Doubleâ€‘click a row to copy â€œHOST IPâ€.'}));

    const list = el('div',{class:'steps'});
    instructions.forEach((s, i)=>{
      const id = 'step_'+i;
      const row = el('label',{class:'step'},
        el('input',{type:'checkbox', onChange:(e)=>{row.classList.toggle('done', e.target.checked)}}),
        el('span',{class:'num'}, String(i+1)),
        el('div',{}, s)
      );
      list.appendChild(row);
    })
    box.appendChild(list);
    return box;
  }

  function searchBox(onInput){
    return el('div',{class:'search panel'},
      el('input',{type:'search', placeholder:'Filter by host, level, IP, VLANâ€¦', onInput:(e)=>onInput(e.target.value.trim().toLowerCase())}),
      badge('âŒš Doubleâ€‘click row copies â€œHOST IPâ€'),
      badge('ðŸ–¨ Printer: HP PCL, A4'),
      badge('ðŸŒ Domain: intellivue.net')
    );
  }

  function renderSummary(){
    const view = $('#view');
    view.innerHTML='';

    const headline = el('div',{class:'panel grid'});
    const byFSE = groupBy(hosts,'fse');

    const left = el('div',{},
      el('h2',{style:'margin:0 0 10px;font-size:18px'},'Today\'s Schedule Overview'),
      el('div',{class:'note'},`Total hosts: ${hosts.length} Â· Ryan: ${byFSE.Ryan?.length||0} Â· Maria: ${byFSE.Maria?.length||0} Â· Kai: ${byFSE.Kai?.length||0}`),
      tableFor([...hosts].sort((a,b)=>a.fse.localeCompare(b.fse)||timeSort(a,b)))
    );

    const vlanCounts = Object.entries(groupBy(hosts,'vlan')).map(([k,v])=>({vlan:k,count:v.length})).sort((a,b)=>a.vlan.localeCompare(b.vlan));
    const right = el('div',{},
      el('h3',{style:'margin:0 0 8px;font-size:16px'},'Quick Facts'),
      el('div',{class:'pill',style:'margin-bottom:8px'}, `Subnets: 255.255.248.0 Â· DNS: 172.31.3.1 / 172.31.3.2`),
      el('div',{class:'panel',style:'padding:12px'},
        el('div',{class:'note',style:'margin-bottom:8px'},'VLAN distribution'),
        el('div',{}, vlanCounts.map(({vlan,count})=>el('div',{style:'display:flex;justify-content:space-between;margin:6px 0'},
          el('span',{},`VLAN ${vlan}`), el('span',{class:'chip'}, String(count))
        )))
      )
    );

    headline.append(left,right);
    view.appendChild(headline);
  }

  function renderFSE(name){
    const view = $('#view'); view.innerHTML='';
    const rows = hosts.filter(h=>h.fse===name).sort(timeSort);

    // Instructions block
    view.appendChild(stepsBlock());

    // Filter + table
    let filtered = rows;
    const onFilter = (q)=>{
      filtered = !q?rows: rows.filter(r=>Object.values(r).join(' ').toLowerCase().includes(q));
      tableWrap.innerHTML='';
      tableWrap.appendChild(tableFor(filtered));
    }
    view.appendChild(searchBox(onFilter));

    const tableWrap = el('div',{class:'panel'});
    tableWrap.appendChild(tableFor(filtered));

    const header = el('div',{style:'display:flex;justify-content:space-between;align-items:center;margin:6px 0 0'},
      el('h2',{style:'margin:0;font-size:18px'}, `${name} Â· Assigned Hosts`),
      el('div',{}, badge(`Total: ${rows.length}`))
    );

    view.appendChild(header);
    view.appendChild(tableWrap);

    // Footnote
    view.appendChild(el('div',{class:'note',style:'margin-top:10px'}, 'Passwords (caseâ€‘sensitive): Config â€œWCX3TCg)â€; FE login â€œFE+Sup42p0rt!â€.'));
  }

  function activate(name){
    document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
    [...document.querySelectorAll('.tab-btn')].find(b=>b.textContent.trim().startsWith(name)).classList.add('active');
    if(name==='Summary') renderSummary(); else renderFSE(name);
  }

  // Init
  renderTabs();
  activate('Summary');
  </script>
</body>
</html>